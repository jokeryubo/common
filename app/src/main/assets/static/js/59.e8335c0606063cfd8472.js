webpackJsonp([59],{tuOt:function(t,i){},zH1q:function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=a("bOdI"),s=a.n(e),n=(a("MY4N"),a("0zAV")),o=a("d4/4"),c=a("B1Az"),l=a("cKc3"),r=a("Au9i"),u=a("NYxO"),h={data:function(){return{slots:[{flex:1,values:[],className:"slot1",textAlign:"center"}],zchType:1,popText:"",popState:!1,topbar:{isShow:!0,title:"填写店铺认证信息",callBack:this.goBack,message:{title:"提示信息",message:"已填的信息将丢失，确认返回？"},sureBack:this.sureBack},UploadData:[],clickPopType:"",shopType:[],shopName:"",AuthenticationAllData:{shop:"选择店铺",shopid:"",CertificatesType:"",CertificatesNumber:"",CertificatesImg:"",StatutoryPerson:"",ContactWay:"",PositiveImg:"",OppositeImg:"",ManagementImg:""},switchText:"统一信用代码",switchType1:!0,switchType2:!1,isActive1:!0,isActive2:!1,Verification:[{value:"",type:!1},{value:"",type:!1}],Norepetition:!1,instance:null}},components:s()({BaseTopbar:o.a,Cell:c.a,Picker:r.Picker,Toast:r.Toast,MessageBox:r.MessageBox},n.a.name,n.a),created:function(){console.log("页面加载"),this.getShopData()},computed:Object(u.b)({}),mounted:function(){$Hybrid.routerList;var t=this;$Hybrid.$eventHub.$off("nativeBack").$on("nativeBack",function(i){var a=$Hybrid.routerList;if("选择店铺"==t.AuthenticationAllData.shop&&""==t.AuthenticationAllData.CertificatesNumber)return 1===a.length?$Hybrid.appToNative("close"):($Hybrid.routerList.pop(),t.$router.go(-1)),!1;r.MessageBox.confirm("",{title:"提示",message:"已填的信息将丢失，确认返回？",showCancelButton:!0,confirmButtonClass:"msg-sure",cancelButtonClass:"msg-canel"}).then(function(i){"confirm"===i&&(1===a.length?$Hybrid.appToNative("close"):($Hybrid.routerList.pop(),t.$router.go(-1)))})}),this.$route.params.data&&(this.$set(this.AuthenticationAllData,"shop",this.$route.params.data.shopName),this.popText=this.$route.params.data.shopTypeName,this.shopType=[{code:this.$route.params.data.shopType,type:this.$route.params.data.shopTypeName}],this.clickPopType="2",this.surePop())},methods:{BtnCheck:function(){if("选择店铺"!=this.AuthenticationAllData.shop||""!=this.AuthenticationAllData.CertificatesNumber||""!=this.AuthenticationAllData.CertificatesImg||""!=this.AuthenticationAllData.PositiveImg||""!=this.AuthenticationAllData.OppositeImg||""!=this.Verification[0].value||""!=this.AuthenticationAllData.StatutoryPerson)return!0},inputCheck:function(t,i){console.log("=======",i),"1"==t&&(this.Verification[0].value=i.target.value.replace(/[^0-9x]/g,"").toUpperCase().slice(0,18)),"3"==t&&(this.AuthenticationAllData.StatutoryPerson=i.target.value.replace(/[^\u4e00-\u9fa5^a-zA-Z]/g,"")),"4"==t&&(this.AuthenticationAllData.CertificatesNumber=i.target.value.replace(/[^0-9A-Za-z]/g,"").toUpperCase()),"5"==t&&(this.AuthenticationAllData.CertificatesNumber=i.target.value.replace(/\D/g,"").slice(0,15))},inputBottom:function(t){if("iOS"==$Hybrid.$type)return!1;document.getElementById("bottom").style.marginBottom=t+"px",document.getElementById("ShopAuthentication").scrollIntoView(!1)},goBack:function(){var t=!1;return this.instanceof&&this.instance.close(),"选择店铺"==this.AuthenticationAllData.shop&&""==this.AuthenticationAllData.CertificatesNumber&&(t=!0),t},getShopData:function(){var t=this;l.a.get({url:"app/shop/info/get"}).then(function(i){if(console.log("店铺数据121",i),null==i||""==i||i.length<1)return t.instance=Object(r.Toast)({message:"您名下暂无店铺，请先创建",position:"bottom",duration:3500}),t.shopName=i,!1;for(var a=[],e=0;e<i.length;e++)if(!i.centificationStatus){var s={};s.name=i[e].shopName,s.id=i[e].id,a.push(s)}t.shopName=a})},inputChange:function(t,i){"1"==t&&(console.log(i.target.value),this.Verification[0].type=!0,this.Verification[0].value=i.target.value,this.RegFunction("1"),document.getElementById("bottom").style.marginBottom="0px"),"3"==t&&(this.AuthenticationAllData.StatutoryPerson=i.target.value,document.getElementById("bottom").style.marginBottom="0px"),"4"==t&&(this.$set(this.AuthenticationAllData,"CertificatesNumber",i.target.value),this.RegFunction("4"))},RegFunction:function(t){var i=!0;if("1"==t){if(!1===(a=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/).test(this.Verification[0].value))return this.instance=Object(r.Toast)({message:"身份证号码不合法",position:"bottom",duration:2e3}),i=!1,!1}else if("2"==t){var a;if(!1===(a=/^1[345789]\d{9}$/).test(this.Verification[1].value))return this.instance=Object(r.Toast)({message:"手机号码不合法",position:"bottom",duration:2e3}),i=!1,!1}return"4"==t&&("统一信用代码"==this.switchText?a=/^[^_IOZSVa-z\W]{2}\d{6}[^_IOZSVa-z\W]{10}$/g:"注册号"==this.switchText&&(a=/^[A-Za-z0-9]\w{14}$/g),!1===a.test(this.AuthenticationAllData.CertificatesNumber))?(this.instance=Object(r.Toast)({message:this.switchText+"号码不合法",position:"bottom",duration:2e3}),i=!1,!1):i},upload:function(t,i){var a=this,e=this;return"PositiveImg"==t?($Hybrid.appToNative("uploadIDCard",!0),this.$eventHub.$off("idcard").$on("idcard",function(t){a.Verification[0].type=!0,a.Verification[0].value=t.idNumber,a.AuthenticationAllData.StatutoryPerson=t.name}),this.$eventHub.$off("face").$on("face",function(t){e.AuthenticationAllData.PositiveImg=t.url}),!1):"OppositeImg"==t?($Hybrid.appToNative("uploadIDCard",!1),this.$eventHub.$off("back").$on("back",function(t){e.AuthenticationAllData.OppositeImg=t.url}),!1):($Hybrid.appToNative("updateImg",t,1,!1),void $Hybrid.$eventHub.$off(t).$on(t,function(i){e.AuthenticationAllData[t]=i.url,console.log(i)}))},switchCertificate:function(t){this.$set(this.AuthenticationAllData,"CertificatesNumber",""),1==t?(this.zchType=1,this.switchText="统一信用代码",this.switchType1=!0,this.switchType2=!1,this.isActive1=!0,this.isActive2=!1):2==t&&(this.zchType=2,this.switchText="注册号",this.switchType1=!1,this.switchType2=!0,this.isActive1=!1,this.isActive2=!0)},Choice:function(t){var i=this;if(this.$route.params.data)return!1;if("1"==t){if(this.shopName.length<1||null==this.shopName||""==this.shopName)return Object(r.Toast)("您名下暂无可认证店铺，请先创建"),!1;try{this.shopName.forEach(function(t,a){i.AuthenticationAllData.shop==t.name&&(i.AuthenticationAllData.shopid=t.id)})}catch(t){this.instance=Object(r.Toast)("您名下暂无店铺，请先创建")}var a=[];this.shopName.forEach(function(t,i){a.push(t.name)}),this.slots[0].values=a}this.popState=!0,this.clickPopType=t},popValue:function(t,i){this.popText=i[0],"1"==this.clickPopType?this.AuthenticationAllData.shopid=this.popText:"2"==this.clickPopType&&(this.AuthenticationAllData.typeid=this.popText)},surePop:function(){"1"==this.clickPopType&&this.$set(this.AuthenticationAllData,"shop",this.popText),this.popState=!1},removePop:function(){console.log(111),this.popState=!1,"选择店铺"==this.AuthenticationAllData.shop?this.AuthenticationAllData.shopid="":"选择类型"==this.AuthenticationAllData.type&&(this.AuthenticationAllData.typeid=""),console.log(this.popState)},Mycheck:function(){var t=this;try{this.shopName.forEach(function(i,a){t.AuthenticationAllData.shop==i.name&&(t.AuthenticationAllData.shopid=i.id)})}catch(t){console.log("数据请求失败，请退出重试")}this.shopType.forEach(function(i,a){t.AuthenticationAllData.type==i.type&&(t.AuthenticationAllData.typeid=i.code)});for(var i=[{name:"请选择店铺",data:this.AuthenticationAllData.shopid},{name:"请填写"+this.switchText,data:this.AuthenticationAllData.CertificatesNumber},{name:"请上传营业执照",data:this.AuthenticationAllData.CertificatesImg},{name:"请上传食品经营许可证",data:this.AuthenticationAllData.ManagementImg},{name:"请上传人像面照片",data:this.AuthenticationAllData.PositiveImg},{name:"请上传国徽面照片",data:this.AuthenticationAllData.OppositeImg},{name:"请填写法人代表姓名",data:this.AuthenticationAllData.StatutoryPerson},{name:"请填写您的身份证号",data:this.Verification[0].value}],a=void 0,e=0;e<i.length;e++)if(""==i[e].data)return Object(r.Toast)({message:i[e].name,position:"bottom",duration:2e3}),a=!1,!1;return a=!(!this.RegFunction("1")||!this.RegFunction("4")),this.UploadData=i,console.log(this.UploadData),a},Mysubmit:function(){var t=this;if(this.instance&&this.instance.close(),!this.Mycheck())return!1;"统一信用代码"==this.switchText?this.AuthenticationAllData.CertificatesType="0":this.AuthenticationAllData.CertificatesType="1";l.a.post({url:"app/shop/certification/add",data:{params:{shopId:this.AuthenticationAllData.shopid,shopType:"1",uniformSocialCreditCode:this.AuthenticationAllData.CertificatesNumber,businessLicenseUrl:this.AuthenticationAllData.CertificatesImg,legalPerson:this.AuthenticationAllData.StatutoryPerson,legalPersonIdCard:this.Verification[0].value,legalPersonIdCardFrontUrl:this.AuthenticationAllData.PositiveImg,legalPersonIdCardBackUrl:this.AuthenticationAllData.OppositeImg,foodBusinessLicense:this.AuthenticationAllData.ManagementImg,otherLicenseUrl:"",memo:"",certificationStatus:0,businessLicenseType:this.AuthenticationAllData.CertificatesType}}}).then(function(i){console.log(i),0==i.code&&($Hybrid.routerList.pop(),t.$router.back(-1)),t.Norepetition=!1}),this.Norepetition=!0}},beforeDestroy:function(){this.$set(this.AuthenticationAllData,"CertificatesNumber",""),this.$set(this.AuthenticationAllData,"shop","选择店铺"),this.$set(this.AuthenticationAllData,"type","选择类型")}},p={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{attrs:{id:"ShopAuthentication"}},[a("BaseTopbar",{attrs:{topbar:t.topbar}}),t._v(" "),a("Cell",{staticClass:"item1",attrs:{title:"认证的店铺","is-link":""}},[a("span",{staticClass:"shop-Name",on:{click:function(i){return t.Choice("1")}}},[t._v(t._s(t.AuthenticationAllData.shop))])]),t._v(" "),a("Cell",{staticClass:"item2",attrs:{title:"认证的类型",borderStyle:"none","is-link":"",isShow:"false"}},[a("span",[t._v("餐饮店铺")])]),t._v(" "),a("div",{staticClass:"warning"},[t._v("\n        请填写店铺的真实信息，以便后期服务\n    ")]),t._v(" "),a("div",{staticClass:"row-box"},[a("div",{staticClass:"margin"},[t._m(0),t._v(" "),a("div",{staticClass:"row-content"},[a("div",{staticClass:"left content",class:{active:t.isActive1},on:{click:function(i){return t.switchCertificate(1)}}},[t._v("                    \n                    统一社会信用代码\n                    "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.switchType1,expression:"switchType1"}]},[a("div",{staticClass:"border"}),t._v(" "),a("i",{staticClass:"icon"})])]),t._v(" "),a("div",{staticClass:"left right content",class:{active:t.isActive2},on:{click:function(i){return t.switchCertificate(2)}}},[t._v("\n                    营业执照注册号\n                    "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.switchType2,expression:"switchType2"}]},[a("div",{staticClass:"border"}),t._v(" "),a("i",{staticClass:"icon"})])])]),t._v(" "),a("div",{staticClass:"row-footer"},[a("span",{staticClass:"title"},[t._v(t._s(t.switchText))]),t._v(" "),a("van-field",{directives:[{name:"show",rawName:"v-show",value:1==t.zchType,expression:"zchType==1?true:false"}],staticClass:"input-text lineHeight-normal",attrs:{"input-align":"right",clearable:"",placeholder:"请填写和证件上一致的有效注册号",maxlength:"18"},on:{blur:function(i){return t.inputChange("4",i)}},nativeOn:{input:function(i){return t.inputCheck("4",i)}},model:{value:t.AuthenticationAllData.CertificatesNumber,callback:function(i){t.$set(t.AuthenticationAllData,"CertificatesNumber",i)},expression:"AuthenticationAllData.CertificatesNumber"}}),t._v(" "),a("van-field",{directives:[{name:"show",rawName:"v-show",value:2==t.zchType,expression:"zchType==2?true:false"}],staticClass:"input-text lineHeight-normal",attrs:{"input-align":"right",clearable:"",placeholder:"请填写和证件上一致的有效注册号",maxlength:"15"},on:{blur:function(i){return t.inputChange("4",i)}},nativeOn:{input:function(i){return t.inputCheck("5",i)}},model:{value:t.AuthenticationAllData.CertificatesNumber,callback:function(i){t.$set(t.AuthenticationAllData,"CertificatesNumber",i)},expression:"AuthenticationAllData.CertificatesNumber"}})],1)])]),t._v(" "),a("div",{staticClass:"row-box"},[a("div",{staticClass:"margin pad"},[t._m(1),t._v(" "),t.AuthenticationAllData.CertificatesImg?a("div",{staticClass:"upload-box",on:{click:function(i){return t.upload("CertificatesImg")}}},[a("img",{staticClass:"upload-img",attrs:{src:t.AuthenticationAllData.CertificatesImg,alt:""}}),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("营业执照")])]):a("div",{staticClass:"upload-box",on:{click:function(i){return t.upload("CertificatesImg")}}},[t._m(2),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("营业执照")])]),t._v(" "),t._m(3),t._v(" "),t.AuthenticationAllData.ManagementImg?a("div",{staticClass:"upload-box",on:{click:function(i){return t.upload("ManagementImg")}}},[a("img",{staticClass:"upload-img",attrs:{src:t.AuthenticationAllData.ManagementImg}}),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("食品经营许可证")])]):a("div",{staticClass:"upload-box",on:{click:function(i){return t.upload("ManagementImg")}}},[t._m(4),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("食品经营许可证")])])])]),t._v(" "),a("div",{staticClass:"warning"},[t._v("\n        请上传法人证件证照片，确保证件照上的姓名及证件号清晰可见\n    ")]),t._v(" "),a("div",{staticClass:"row-box"},[a("div",{staticClass:"margin"},[t._m(5),t._v(" "),a("div",{staticClass:"flex-box"},[t.AuthenticationAllData.PositiveImg?a("div",{staticClass:"upload-box width-340",on:{click:function(i){return t.upload("PositiveImg")}}},[a("img",{staticClass:"upload-img",attrs:{src:t.AuthenticationAllData.PositiveImg}}),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("人像面照片")])]):a("div",{staticClass:"upload-box width-340",on:{click:function(i){return t.upload("PositiveImg")}}},[t._m(6),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("人像面照片")])]),t._v(" "),t.AuthenticationAllData.OppositeImg?a("div",{staticClass:"upload-box width-340",on:{click:function(i){return t.upload("OppositeImg")}}},[a("img",{staticClass:"upload-img",attrs:{src:t.AuthenticationAllData.OppositeImg}}),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("国徽面照片")])]):a("div",{staticClass:"upload-box width-340",on:{click:function(i){return t.upload("OppositeImg")}}},[t._m(7),t._v(" "),a("div",{staticClass:"footer-opacity"},[t._v("国徽面照片")])])])])]),t._v(" "),a("div",{staticClass:"row-box",attrs:{id:"bottom"}},[a("Cell",{staticClass:"item1",staticStyle:{margin:"0"},attrs:{title:"法定代表人","is-link":"",isShow:"false"}},[a("van-field",{staticClass:"input-width lineHeight-normal",attrs:{"input-align":"right",clearable:"",placeholder:"请填写法人代表姓名",maxlength:"30"},on:{blur:function(i){return t.inputChange("3",i)},focus:function(i){return t.inputBottom(190)}},nativeOn:{input:function(i){return t.inputCheck("3",i)}},model:{value:t.AuthenticationAllData.StatutoryPerson,callback:function(i){t.$set(t.AuthenticationAllData,"StatutoryPerson",i)},expression:"AuthenticationAllData.StatutoryPerson"}})],1),t._v(" "),a("Cell",{staticClass:"item1 item2",attrs:{title:"身份证号","is-link":"",isShow:"false",borderStyle:"none"}},[a("van-field",{staticClass:"input-width lineHeight-normal",attrs:{"input-align":"right",clearable:"",placeholder:"请填写您的身份证号",maxlength:"18"},on:{blur:function(i){return t.inputChange("1",i)},focus:function(i){return t.inputBottom(190)}},nativeOn:{input:function(i){return t.inputCheck("1",i)}},model:{value:t.Verification[0].value,callback:function(i){t.$set(t.Verification[0],"value",i)},expression:"Verification[0].value"}})],1)],1),t._v(" "),a("div",{staticClass:"footer-message"},[t._v("\n        快快将严格保证您的数据和隐私安全\n    ")]),t._v(" "),a("div",{staticClass:"footer-button",class:t.BtnCheck()?"":"no",on:{click:t.Mysubmit}},[t._v("提交")]),t._v(" "),a("mt-popup",{staticClass:"mint-popup",attrs:{position:"bottom"},model:{value:t.popState,callback:function(i){t.popState=i},expression:"popState"}},[a("div",{staticClass:"msg"},[a("p",{staticClass:"cancel",on:{click:t.removePop}},[t._v("取消")]),t._v(" "),a("p",{staticClass:"save",on:{click:t.surePop}},[t._v("确定")])]),t._v(" "),a("mt-picker",{ref:"pickCom",attrs:{slots:t.slots,showToolbar:!0},on:{change:t.popValue}})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"row-title"},[i("span",{staticClass:"icon"}),this._v(" "),i("span",{staticClass:"text"},[this._v("证件类型")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"row-title"},[i("span",{staticClass:"text"},[this._v("营业执照")]),this._v(" "),i("span",{staticClass:"text-desc"},[this._v("营业执照副本盖章扫描件，不超过10M（jpg/png/jpeg/bmp）")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"add-icon"},[i("img",{attrs:{src:a("I0c5"),alt:""}})])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"row-title title-top"},[i("span",{staticClass:"text"},[this._v("食品经营许可证")]),this._v(" "),i("span",{staticClass:"text-desc"},[this._v("\n                    盖章扫描件，不超过10M（jpg/png/jpeg/bmp）\n                ")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"add-icon"},[i("img",{attrs:{src:a("I0c5")}})])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"row-title"},[i("span",{staticClass:"icon"}),this._v(" "),i("span",{staticClass:"text"},[this._v("法定代表人身份证明")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"add-icon"},[i("img",{attrs:{src:a("I0c5")}})])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"add-icon"},[i("img",{attrs:{src:a("I0c5")}})])}]};var v=a("VU/8")(h,p,!1,function(t){a("tuOt")},"data-v-823f2910",null);i.default=v.exports}});