webpackJsonp([91],{pViW:function(e,t){},yuyI:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mvHQ"),i=s.n(a),n=s("d4/4"),o=s("B1Az"),c=s("cKc3"),r=s("Au9i"),u={data:function(){return{topbar:{isShow:!0,title:"采购需求单",callBack:this.goBack,message:{title:"提示信息",message:"已填的信息将丢失，确认返回？"},sureBack:this.sureBack},popupVisible:!1,describe:"",shopname:"请选择",dataList:[{flex:1,values:[],className:"slot1",textAlign:"center"}],PurchaseData:[],timer:null}},components:{BaseTopbar:n.a,Cell:o.a,MessageBox:r.MessageBox,Toast:r.Toast},created:function(){this.$eventHub.$on("location",function(e){})},mounted:function(){},computed:{cannext:function(){return""!==this.describe&&"请选择"!==this.shopname},nohightLight:function(){return""===this.describe&&"请选择"===this.shopname},describeNumber:function(){return this.describe.length||0}},methods:{goBack:function(){return""===this.describe&&"请选择"===this.shopname},sureBack:function(){$Hybrid.appToNative("close")},handleClick:function(){var e=this;if(this.popupVisible=!0,this.dataList[0].values.length>0)return!1;c.a.get({url:"app/provider/info/get/type/provider",data:{params:{type:""}}}).then(function(t){e.PurchaseData=t;var s=[];e.PurchaseData.forEach(function(e){s.push(e.shopName)}),e.dataList[0].values=s,console.log(t)})},cancel:function(){this.popupVisible=!1},sureCasetype:function(){this.popupVisible=!1,this.shopname=this.$refs.pickCom.getValues()[0]},onDateChange:function(){},save:function(){var e=this;if(""!=this.describe)if("请选择"!=this.shopname){var t="";this.PurchaseData.forEach(function(s){e.shopname==s.shopName&&(t=s.id)});this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e.timer=null,c.a.post({url:"app/purchase/add",data:{params:{procurementDemand:e.describe,providerId:t}}}).then(function(t){$Hybrid.appToNative("close");var s=(new Date).getTime();$Hybrid.appToNative("makeChat",i()({id:t.data.purchaseId,title:"采购需求单",userId:t.data.userId,nickName:t.data.nickName,salary:"",describe:e.describe,tagList:[],senderAvatar:"",senderName:"",timestamp:Number(s),jobCity:"",isinvite:!1}))})},500)}else Object(r.Toast)({message:"信息不完善，请完善",position:"bottom"});else Object(r.Toast)({message:"请简要描述您的采购需求",position:"bottom"})}}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"PurchaseRequirement"},[s("BaseTopbar",{attrs:{topbar:e.topbar}}),e._v(" "),s("div",{staticClass:"mainBox"},[s("div",{staticClass:"describeBox"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.describe,expression:"describe"}],staticClass:"describe",attrs:{maxlength:"500",placeholder:"请简要描述您的采购需求"},domProps:{value:e.describe},on:{input:function(t){t.target.composing||(e.describe=t.target.value)}}}),e._v(" "),s("span",{staticClass:"textNum"},[s("span",{staticClass:"green"},[e._v(e._s(e.describeNumber))]),e._v("/500")])])]),e._v(" "),s("Cell",{staticClass:"item",attrs:{title:"选择服务商","is-link":""}},[s("span",{on:{click:function(t){return e.handleClick()}}},[e._v(e._s(e.shopname))])]),e._v(" "),s("button",{class:e.nohightLight?"saveBtn no":"saveBtn",on:{click:function(t){return e.save()}}},[e._v("\n        发起需求\n    ")]),e._v(" "),s("mt-popup",{staticClass:"prop-tk",attrs:{position:"bottom"},model:{value:e.popupVisible,callback:function(t){e.popupVisible=t},expression:"popupVisible"}},[s("div",{staticClass:"clR"},[s("p",{staticClass:"cancel",on:{click:e.cancel}},[e._v("取消")]),e._v(" "),s("p",{staticClass:"save",on:{click:e.sureCasetype}},[e._v("确定")])]),e._v(" "),s("mt-picker",{ref:"pickCom",attrs:{slots:e.dataList,"visible-item-count":5,"show-toolbar":!1,"value-key":"cName"},on:{change:e.onDateChange}})],1)],1)},staticRenderFns:[]};var l=s("VU/8")(u,p,!1,function(e){s("pViW")},"data-v-400f8cc9",null);t.default=l.exports}});