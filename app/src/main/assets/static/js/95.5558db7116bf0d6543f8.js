webpackJsonp([95],{KfUF:function(e,t){},OyEl:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),r=a("bOdI"),o=a.n(r),n=(a("MY4N"),a("0zAV")),d=a("d4/4"),c=a("w2+g"),l=a("cU4i"),m=a("B1Az"),h=a("cKc3"),u=a("Au9i"),p={data:function(){return{topbar:{isShow:!0,title:"税务代办需求单",callBack:this.goBack},params:{saveEditAddressInfo:!1,changeLocalMyinfo:!1,hasAddressInfo:!1,Address:{}},selectionData:[],mealId:"",mealName:"",imgUrl:"",operatorName:"",detialAddress:"",placetag:"请选择",provinceId:"",cityId:"",districtId:"",timer:null,hasAddr:!1,defaultAddrValue:"",cityName:"",errorMst:""}},components:o()({BaseTopbar:d.a,Cell:m.a,MessageBox:u.MessageBox,Toast:u.Toast,AddressSelection:c.a,AddressPopup:l.a},n.a.name,n.a),created:function(){this.handleMeals(),this.$eventHub.$off("toLogin").$on("toLogin",function(e){var t=e.token;$Hybrid.$token=t})},mounted:function(){if(window.sessionStorage.getItem("edittaxationOrder")){var e=JSON.parse(window.sessionStorage.getItem("edittaxationOrder"));this.operatorName=e.operatorName,this.detialAddress=e.address,this.imgUrl=e.businessLicense,this.mealId=e.mealId}},computed:{canSubmit:function(){return""!==this.operatorName&&""!==this.detialAddress&&"请选择"!==this.placetag},nohightLight:function(){return""===this.operatorName&&""===this.detialAddress&&"请选择"===this.placetag}},destroyed:function(){this.$eventHub.$off("toLogin")},methods:{handleAddrCell:function(){this.hasAddr=!0},handleOverlay:function(){this.hasAddr=!1},handleAddrConfirm:function(e){this.placetag=e[0].name+"-"+e[1].name+"-"+e[2].name,this.provinceId=e[0].code,this.cityId=e[1].code,this.districtId=e[2].code,this.hasAddr=!1,this.cityName=e[1].name,this.handleMeals()},handleMeals:function(){var e=this;this.cityName=this.cityName?this.cityName:this.$eventHub._data.$location.cityName,console.log(this.cityName),h.a.get({url:"order/taxagent/meals",data:{params:{cityName:this.cityName}}}).then(function(t){console.log(t),e.selectionData=t,e.selectionData.forEach(function(e,t){0==t&&(e.checked=!0)}),e.mealId=t[0].mealId,e.mealName=t[0].mealName,e.errorMst=""}).catch(function(t){e.errorMst="该城市暂未开通服务，请选择别的城市",e.selectionData=[]})},goBack:function(){return window.sessionStorage.removeItem("edittaxationOrder"),!0},uploadImg:function(){var e=this;$Hybrid.appToNative("updateImg","picture"),$Hybrid.$eventHub.$off("picture").$on("picture",function(t){e.imgUrl=t})},checkoperatorName:function(){this.operatorName=this.operatorName.replace(/[^A-Za-z0-9_\u4e00-\u9fa5]/g,"")},check:function(e){var t=this;this.selectionData.forEach(function(a,i){a.mealName==e.mealName?(console.log("value",a),a.checked=!0,t.mealId=a.mealId,t.mealName=a.mealName):a.checked=!1})},save:function(){var e=this;if(!this.canSubmit)return Object(u.Toast)({message:"请补全信息",position:"bottom"}),!1;if(!$Hybrid.$token)return $Hybrid.appToNative("toLogin"),!1;var t={operatorName:this.operatorName,provinceId:this.provinceId,cityId:this.cityId,districtId:this.districtId,address:this.detialAddress,mealId:this.mealId,mealName:this.mealName};this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e.timer=null,h.a.post({url:"order/taxagent/order",data:{params:t}}).then(function(a){window.sessionStorage.setItem("edittaxationOrder",s()(t)),0==a.code&&e.$router.push({name:"OrderTaxation"})})},500)}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"AccreditationRequirementSub"},[a("BaseTopbar",{attrs:{topbar:e.topbar}}),e._v(" "),a("div",{staticClass:"content"},[a("Cell",{staticClass:"item",attrs:{title:"经营者姓名",isShow:"false","is-link":""}},[a("van-field",{staticClass:"user-name lineHeight-normal",attrs:{"input-align":"right",clearable:"",maxlength:"20",placeholder:"请输入经营者姓名"},on:{input:function(t){return e.checkoperatorName()}},model:{value:e.operatorName,callback:function(t){e.operatorName=t},expression:"operatorName"}})],1),e._v(" "),a("Cell",{staticClass:"item",attrs:{title:"经营场所(地址)",emit:e.handleAddrCell,"is-link":""}},[a("span",{staticClass:"pacle"},[e._v(e._s(e.placetag))])]),e._v(" "),a("div",{staticClass:"describeBox"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.detialAddress,expression:"detialAddress"}],staticClass:"describe",attrs:{placeholder:"请输入详细地址（精确到楼层门牌号）",maxlength:"50"},domProps:{value:e.detialAddress},on:{input:function(t){t.target.composing||(e.detialAddress=t.target.value)}}})])],1),e._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"meal"},[a("div",{staticClass:"title"},[e._v("套餐选择")]),e._v(" "),e._l(e.selectionData,function(t,i){return a("div",{key:i,staticClass:"radio-box",on:{click:function(a){return e.check(t)}}},[a("div",{staticClass:"icon-check"},[a("span",{staticClass:"radio",class:{on:t.checked}}),e._v(" "),a("input",{staticClass:"input-radio",attrs:{type:"radio"},domProps:{checked:t.checked}})]),e._v(" "),a("div",{staticClass:"item-content"},[a("span",{staticClass:"name"},[e._v(e._s(t.mealName))]),e._v(" "),a("span",{staticClass:"price"},[e._v("    ¥"+e._s(t.mealMoney))])])])})],2),e._v(" "),e.errorMst?a("div",{staticClass:"mealErr"},[e._v(e._s(e.errorMst))]):e._e()]),e._v(" "),a("button",{class:e.nohightLight?"saveBtn no":"saveBtn",on:{click:function(t){return e.save()}}},[e._v("\n        发起需求\n    ")]),e._v(" "),a("address-popup",{attrs:{show:e.hasAddr,defaultValue:e.defaultAddrValue},on:{overlayState:e.handleOverlay,confirmData:e.handleAddrConfirm}})],1)},staticRenderFns:[]};var f=a("VU/8")(p,v,!1,function(e){a("KfUF")},"data-v-3349f26c",null);t.default=f.exports}});